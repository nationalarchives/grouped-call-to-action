/*! Minified JavaScript created in Discovery 18.02.2019. 2019-03-07 */

$(function(){var t=$("#staffViewOfOtherUserDOs"),i="View delivery options presented to other users";t.find("> div").length&&(t.hide(),$link=$("<a>",{href:"#",text:i,class:"discoveryPrimaryCallToActionLink",click:function(e){t.slideToggle(),$link.text()===i?$link.text("Hide delivery options presented to other users"):$link.text(i),e.preventDefault()}}).appendTo($("#staffViewOfOtherUserDOsWrapper")));var n=$("#imageViewerLink"),o=$("#imageViewerApp"),a="Preview an image of this record.";isBootstrapped=!1,n.text(a),$(".image-info").hide(),n.on("click touchstart",function(e){$(".image-info").toggle();n.attr("data-iaid"),n.attr("data-thumbServiceUrl");if(n.text()===a)return isBootstrapped?o.show():(isBootstrapped=!0,angular.module("imageViewerApp"),o.show(),angular.bootstrap(document.getElementById("imageViewerApp"),["imageViewerApp"])),n.text("Hide images"),void n.toggleClass("expandedImageViewer");n.text(a),n.toggleClass("expandedImageViewer"),o.hide(),Modernizr.hashchange||e.preventDefault()}),function(){$details=$("#name-authority .asset-details"),$details.hide();var e=$("<button>",{text:"View details of this record creator",class:"call-to-action-link",click:function(){$details.is(":visible")?$(this).text("View details of this record creator"):$(this).text("Hide details of this record creator"),$details.toggle()}}).css({float:"right"});$details.after(e)}()}),$(document).ready(function(){$supplemental=$(".supplemental-content"),$expander=$(".expander-link"),$supplemental.hide(),$expander.on("click",function(e){e.preventDefault(),$(this).toggleClass("expanded"),$supplemental.toggle()})});var showAll='<p class="center"><a id="show-all">Show all matches</a></p>',numItems=$(".ttt-item").length;$(document).ready(function(){$(".ttt-item").hide(),$(".ttt-item:lt(3)").show(),3<numItems&&$("#traces-through-time-collection").append(showAll),$("#show-all").on("click",function(){$(".ttt-item").show(),$(this).hide()})}),$(document).ready(function(){var t=function(e){e.attr("aria-expanded",function(e,t){return"true"==t?"false":"true"})};$("#suggest-a-correction-form").hide(),$("#show-suggestion-form").on("click",function(e){t($(this)),e.preventDefault(),1==$("#suggest-a-correction-form").length&&($("#suggest-a-correction-form").toggle(),$("#fieldContainingError").focus(),t($("#suggest-a-correction-form")))})}),$(document).ready(function(){$("#hierarchy button").on("click",function(){$(window).width()<=768&&($("#hierarchy ul > li").slideToggle("fast"),$(this).toggleClass("upToggle"),$("#hierarchy nav > a").toggleClass("openFolder"))}),$("#imageViewerLink").on("click",function(e){e.preventDefault()}),function(){$("#invite-feedback").next(".emphasis-block"),$("#imageViewerApp").length,document.querySelector("#tag-delete-success-message"),$("#invite-feedback").next().is(".emphasis-block");$("#add-tag-list .emphasis-block","#reportTagCompletionMessage").is(":visible")&&document.getElementById("user-contributions").scrollIntoView(!0);$(".emphasis-block").is(":visible")&&document.getElementById("invite-feedback").scrollIntoView(!0)}()}),function(l){l.fn.flag_tagging=function(e){return this.each(function(){var r=l(this),s=l("#report-tag",r),c=l(".general-tag-list-item",r),d=function(e){e.attr("aria-expanded",function(e,t){return"true"==t?"false":"true"})};c.on("click",".flagTagLink",function(e){d(l(this)),d(s),e.preventDefault();var t=l(e.delegateTarget),i=l(e.target).data("tagid"),n=l(".tagName",t).text(),o=l(".tagToBeRemoved",r),a=l("#tagId",r);$hiddenFieldValue=l("#tagValue",r),c.removeClass("selected-for-flagging"),t.addClass("selected-for-flagging"),o.text(n),a.val(i),$hiddenFieldValue.val(n),s.show()}),l("input[type=reset]",r).on("click",function(e){d(s),d(l(".flagTagLink")),e.preventDefault(),s.hide(),c.removeClass("selected-for-flagging")})})}}(jQuery),jQuery.fn.confirmDeleteFlag=function(){return this.on("click",function(){return confirm("Are you sure you want to delete this tag?")})},$("#user-contributions").flag_tagging(),$("a.deleteTag").confirmDeleteFlag(),function(r){r.fn.discoveryExploreSurvey=function(e){r.extend({},r.fn.discoveryExploreSurvey.defaults,e);return this.each(function(){var i=r(this),n=function(e){e.find("form").slideUp();r("<p>",{text:"Thank you for your feedback."}).hide().appendTo(e).fadeIn()},o=function(e){dataLayer.push({event:"Discovery",eventCategory:"Discovery",eventAction:"Feedback",eventLabel:e})},a=function(){r("#reasons-for-dissatisfaction").attr("aria-expanded",function(e,t){return"true"==t?"false":"true"})};r(this).find("#reasons-for-dissatisfaction").hide(),i.on("change click",function(e){var t=r(e.target);switch(!0){case"room-for-improvement-no"===t.attr("id"):n(i),o("Nothing to improve");break;case"room-for-improvement-yes"===t.attr("id"):i.find("#initial-question").hide(),i.find("#reasons-for-dissatisfaction").fadeIn(),i.find("input[type=checkbox]").first().focus(),o("Something to improve"),a()}}),i.on("submit",function(e){var t;e.preventDefault(),n(i),t=[],r("#did-not-understand").prop("checked")&&t.push("Did not understand"),r("#too-much-information").prop("checked")&&t.push("Too much information"),r("#expected-the-record").prop("checked")&&t.push("Expected the record"),r("#access-the-record").prop("checked")&&t.push("Did not understand how to access the record"),r("#did-not-know-was-tna").prop("checked")&&t.push("Did not know I was looking at TNA website"),r("#other").prop("checked")&&t.push("Other"),r("#explore-comments").val()&&t.push("Comments:"+r("#explore-comments").val()),t.forEach(function(e){o(e)}),a()}),r('#reasons-for-dissatisfaction [type="reset"]').on("click",function(){r("#reasons-for-dissatisfaction").hide(),r("#initial-question").show(),a()})})}}(jQuery),$("#discovery-explore-survey").discoveryExploreSurvey();var imageviewerFeedback=function(){$("#imageViewverFeedbackWidget").show();var i,n=document.getElementsByName("choice"),o=[],t=$("#imageViewverFeedbackWidget form");$("input[name*='choice']").on("click",function(){$("#submitImageViewerFeedback").prop("disabled",!1)}),t.on("submit",function(e){e.preventDefault(),function(){for(var e=0;e<n.length;e++)if(n[e].checked){i=n[e].value;break}o.push(i);var t=o.pop();dataLayer.push({event:"Discovery",eventCategory:"Discovery",eventAction:"Imageviwer Feedback",eventLabel:"Imageviewer hijack keys is currently being fixed.",eventValue:t})}(),t.slideUp("slow",function(){}),$("#imageViewverFeedbackWidget p").replaceWith("<p style='margin-bottom: 0'>Thank you for your feedback.</p>").fadeIn()})};imageviewerFeedback();